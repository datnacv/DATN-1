<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<body>
<nav th:fragment="navbar(user, keyword, cartCount)"
     class="navbar navbar-expand-lg sticky-top shadow-sm">
  <div class="container d-flex justify-content-between align-items-center py-2">
    <!-- Logo -->
    <a class="navbar-brand text-white fw-bold fs-4" href="/">ACV Store</a>


    <!-- Tìm kiếm -->
    <form class="flex-grow-1 mx-3 position-relative" style="max-width: 600px;" action="/search" method="get">
      <div class="input-group">
        <input type="text" class="form-control rounded-start-pill border-0"
               placeholder="Tìm kiếm sản phẩm..."
               name="keyword" id="searchInput" th:value="${keyword}" autocomplete="off">
        <button class="btn btn-light rounded-end-pill px-4" type="submit">
          <i class="fas fa-search text-blue-800"></i>
        </button>
      </div>
      <div id="searchSuggestions" class="search-suggestions"></div>
    </form>

    <!-- Giỏ hàng + Người dùng -->
    <div class="d-flex align-items-center gap-3">
      <!-- Giỏ hàng -->
      <a th:href="@{/cart}" class="text-white fs-5 position-relative" aria-label="Giỏ hàng">
        <i class="fas fa-shopping-cart"></i>
        <span id="cart-count"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
              th:text="${cartCount != null} ? ${cartCount} : 0">0</span>
      </a>

      <!-- Nếu đã đăng nhập -->
      <div th:if="${user != null}" class="dropdown">
        <button class="btn text-white fw-semibold dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fas fa-user-circle me-1"></i> <span th:text="${user.hoTen}">Tên người dùng</span>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" th:href="@{/profile}">Tài khoản của tôi</a></li>
          <li><a class="dropdown-item" th:href="@{/dsdon-mua}">Đơn mua</a></li>
          <li><a class="dropdown-item" th:href="@{/vi}">Ví thanh toán</a></li>
          <li><hr class="dropdown-divider"></li>
          <li><a class="dropdown-item text-danger" th:href="@{/customers/logout}">Đăng xuất</a></li>
        </ul>
      </div>

      <!-- Nếu chưa đăng nhập -->
      <a th:if="${user == null}" th:href="@{/customers/login}" class="btn btn-light fw-semibold rounded-pill px-3" id="loginButton">
        Đăng nhập
      </a>
    </div>
  </div>
</nav>

<!-- Nếu muốn inject script qua fragment (tuỳ chọn) -->
<th:block th:fragment="navbarScripts">
  <script src="/js/navbar.js"></script>
</th:block>
</body>
</html>